#version 420 compatibility

in highp vec3 in_position;
in highp vec3 in_normal;
in highp vec2 in_texcoord;

//in highp vec3 in_lightPosition;

in highp vec3 in_lightDirection;
in highp float in_lightDistance;

out highp vec3 out_lighting;
out highp vec3 out_direction;

out highp vec3 out_normal;
out highp vec2 out_texcoord;

void main(){
	gl_Position = ftransform();
	
	highp vec3 normal = normalize(gl_NormalMatrix * in_normal);
	

	highp vec3 ambient = vec3(0, 0, 0);
	highp vec3 diffuse = vec3(1, 1, 1);

	

	//vec3 position = vec3(0, 0, 0);
	
	
	//highp vec3 direction = normalize(position - in_position);
	
	highp vec3 direction = normalize(gl_NormalMatrix * in_lightDirection);
	
	
	out_normal = normal;
	out_texcoord = in_texcoord;
	out_direction = direction;
	
	float directional = max(dot(normal, direction), 0.0);
	

	out_lighting = ambient + (diffuse * directional);
	out_lighting *= in_lightDistance;
}